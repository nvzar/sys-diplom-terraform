# –î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ Yandex Cloud

## –û–ø–∏—Å–∞–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –≤–µ–±-—Å–∞–π—Ç–∞ –≤ Yandex Cloud —Å:
- Load Balancing
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º (Zabbix)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (Elasticsearch + Kibana)
- –†–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º (Snapshot Schedule)

## üìä –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

### Terraform Output
![Terraform Output](screenshots/01-terraform-output.png)

### –í–ú –≤ —Å—Ç–∞—Ç—É—Å–µ RUNNING
![VMs Running](screenshots/02-vms-running.png)

### Zabbix Dashboard
![Zabbix Dashboard](screenshots/03-zabbix-dashboard.png)

### Kibana Dashboard
![Kibana Dashboard](screenshots/04-kibana-dashboard.png)

### Security Groups
![Security Groups](screenshots/05-security-groups.png)

### Snapshot Schedules
![Snapshot Schedules](screenshots/06-snapshot-schedules.png)

### GitHub Repository
![GitHub Repo](screenshots/07-github-repo.png)

### Bastion SSH Access
![Bastion SSH](screenshots/08-bastion-ssh.png)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ç—å
- **VPC Network**: diplom-network
- **–ü—É–±–ª–∏—á–Ω–∞—è –ø–æ–¥—Å–µ—Ç—å**: public-subnet (ru-central1-a)
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –ø–æ–¥—Å–µ—Ç–∏**: 
  - private-subnet-a (ru-central1-a)
  - private-subnet-b (ru-central1-b)
- **NAT Gateway**: –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å–µ—Ç–µ–π
- **Bastion Host**: –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –í–ú —á–µ—Ä–µ–∑ SSH

### –í–µ–±-—Å–µ—Ä–≤–µ—Ä—ã
- **web-1** (192.168.20.21) - Nginx –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏ –∑–æ–Ω—ã A
- **web-2** (192.168.30.27) - Nginx –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏ –∑–æ–Ω—ã B
- **Load Balancer**: Application Load Balancer –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Zabbix Server** (158.160.127.151) - –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏
- **Zabbix Agents** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ web-1 –∏ web-2
- –î–∞—à–±–æ—Ä–¥—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ CPU, RAM, –¥–∏—Å–∫–∏, —Å–µ—Ç—å, HTTP –∑–∞–ø—Ä–æ—Å—ã

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Elasticsearch** (192.168.20.9) - –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏
- **Kibana** (158.160.124.158) - –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Snapshot Schedule** –¥–ª—è –≤—Å–µ—Ö –í–ú
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ 2:00 AM UTC
- –•—Ä–∞–Ω–µ–Ω–∏–µ 7 —Å–Ω–∏–º–∫–æ–≤ (1 –Ω–µ–¥–µ–ª—è)

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Terraform >= 1.0
- Yandex Cloud CLI
- SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

### –®–∞–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¢–µ—Ä—Ä–∞—Ñ–æ—Ä–º.
cd ~/sys-diplom-terraform
–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è terraform

2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
terraform –ø—Ä–∏–º–µ–Ω–∏—Ç—å -–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ

3. –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ
–≤—ã—Ö–æ–¥ —Ç–µ—Ä—Ä–∞—Ñ–æ—Ä–º–∏–Ω–≥–∞

—Ç–µ–∫—Å—Ç

## –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

### Zabbix (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- **URL**: http://158.160.127.151
- **–õ–æ–≥–∏–Ω**: admin
- **–ü–∞—Ä–æ–ª—å**: zabbix

### Kibana (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **URL**: http://158.160.124.158:5601
- **Elasticsearch API**: http://192.168.20.9:9200

### Bastion Host
SSH –¥–æ—Å—Ç—É–ø –∫ bastion
ssh -i ~/.ssh/id_rsa ubuntu@158.160.55.35

SSH —á–µ—Ä–µ–∑ –±–∞—Å—Ç–∏–æ–Ω –∫ web-1
ssh -i ~/.ssh/id_rsa -o "ProxyCommand=ssh -i ~/.ssh/id_rsa -W %h:%p ubuntu@158.160.55.35" ubuntu@192.168.20.21

SSH —á–µ—Ä–µ–∑ –±–∞—Å—Ç–∏–æ–Ω –∫ web-2
ssh -i ~/.ssh/id_rsa -o "ProxyCommand=ssh -i ~/.ssh/id_rsa -W %h:%p ubuntu@158.160.55.35" ubuntu@192.168.30.27

SSH —á–µ—Ä–µ–∑ –±–∞—Å—Ç–∏–æ–Ω –∫ Elasticsearch
ssh -i ~/.ssh/id_rsa -o "ProxyCommand=ssh -i ~/.ssh/id_rsa -W %h:%p ubuntu@158.160.55.35" ubuntu@192.168.20.9

—Ç–µ–∫—Å—Ç

## –§–∞–π–ª—ã Terraform

- `main.tf` - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (VPC, –ø–æ–¥—Å–µ—Ç–∏, Security Groups)
- `instances.tf` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –í–ú
- `alb.tf` - Application Load Balancer
- `outputs.tf` - –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `snapshots.tf` - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤
- `variables.tf` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è - –í–´–ü–û–õ–ù–ï–ù–û ‚úÖ

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚úÖ Terraform –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç–∫–∏
‚úÖ VPC Network —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏
‚úÖ Bastion Host –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –í–ú
‚úÖ NAT Gateway –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### –í–µ–±-—Å–∞–π—Ç
‚úÖ –î–≤–µ –í–ú –≤ —Ä–∞–∑–Ω—ã—Ö –∑–æ–Ω–∞—Ö (web-1, web-2)
‚úÖ Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –æ–±–µ–∏—Ö –í–ú
‚úÖ –í–ú –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤ (–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–µ—Ç–∏)
‚úÖ –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Bastion SSH
‚úÖ –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–ø–æ—Ä—Ç–∞–º —á–µ—Ä–µ–∑ Load Balancer

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
‚úÖ Application Load Balancer —Å–æ–∑–¥–∞–Ω
‚úÖ Target Group —Å –¥–≤—É–º—è web-—Å–µ—Ä–≤–µ—Ä–∞–º–∏
‚úÖ Backend Group —Å health check –Ω–∞ / –∏ –ø–æ—Ä—Ç 80
‚úÖ HTTP Router
‚úÖ Listener –Ω–∞ –ø–æ—Ä—Ç—É 80

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚úÖ Zabbix Server —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚úÖ Zabbix Agents –Ω–∞ –≤—Å–µ—Ö –í–ú
‚úÖ –î–∞—à–±–æ—Ä–¥—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ USE (CPU, RAM, –¥–∏—Å–∫–∏, —Å–µ—Ç—å, HTTP)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚úÖ Elasticsearch —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏
‚úÖ Kibana —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏
‚úÖ –°–≤—è–∑—å –º–µ–∂–¥—É Kibana –∏ Elasticsearch

### –°–µ—Ç—å
‚úÖ –û–¥–∏–Ω VPC
‚úÖ Security Groups –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã
‚úÖ Bastion Host —Å –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–æ–ª—å–∫–æ SSH –ø–æ—Ä—Ç–æ–º

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
‚úÖ Snapshot Schedule –¥–ª—è –≤—Å–µ—Ö –í–ú
‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (0 2 * * *)
‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ 7 —Å–Ω–∏–º–∫–æ–≤ (1 –Ω–µ–¥–µ–ª—è)

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Terraform

bastion_public_ip = "158.160.55.35"
elasticsearch_private_ip = "192.168.20.9"
kibana_public_ip = "158.160.124.158"
web-1_fqdn = "web-1.ru-central1.internal"
web-1_private_ip = "192.168.20.21"
web-2_fqdn = "web-2.ru-central1.internal"
web-2_private_ip = "192.168.30.27"
zabbix_public_ip = "158.160.127.151"

## –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–∫—Ä–∏–Ω—à–æ—Ç |
|-----------|---------|
| –†–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã | ![Running](./screenshots/running.png) |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ | ![Sys-diplom](./screenshots/sys-diplom.png) |


—Ç–µ–∫—Å—Ç

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Filebeat –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ç—è–º –∏–∑ –æ–±–ª–∞–∫–∞
- ALB –∏–º–µ–µ—Ç –±–∞–≥ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ Terraform (endpoint –æ—Å—Ç–∞–µ—Ç—Å—è null, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)

## –°—Ç–æ–∏–º–æ—Å—Ç—å

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏:
- 2 —è–¥—Ä–∞, 20% Intel Ice Lake
- 2-4 –ì–± –ø–∞–º—è—Ç–∏
- 10 –ì–± SSD
- –ü—Ä–µ—Ä—ã–≤–∞–µ–º—ã–µ –í–ú (–¥–µ—à–µ–≤–ª–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö)

## –ê–≤—Ç–æ—Ä

–ù–∏–∫–æ–ª–∞–π –ó–∞—Ä—É–±–æ–≤
nvzarubov@gmail.com
